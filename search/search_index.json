{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"\u041c\u0438\u043d\u0438\u0441\u0442\u0435\u0440\u0441\u0442\u0432\u043e \u043d\u0430\u0443\u043a\u0438 \u0438 \u0432\u044b\u0441\u0448\u0435\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0439 \u0424\u0435\u0434\u0435\u0440\u0430\u0446\u0438\u0438     \u0444\u0435\u0434\u0435\u0440\u0430\u043b\u044c\u043d\u043e\u0435 \u0433\u043e\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435 \u0430\u0432\u0442\u043e\u043d\u043e\u043c\u043d\u043e\u0435 \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0443\u0447\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u0435     \u0432\u044b\u0441\u0448\u0435\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f      \u00ab\u041d\u0410\u0426\u0418\u041e\u041d\u0410\u041b\u042c\u041d\u042b\u0419 \u0418\u0421\u0421\u041b\u0415\u0414\u041e\u0412\u0410\u0422\u0415\u041b\u042c\u0421\u041a\u0418\u0419 \u0423\u041d\u0418\u0412\u0415\u0420\u0421\u0418\u0422\u0415\u0422 \u0418\u0422\u041c\u041e\u00bb \u041e\u0422\u0427\u0415\u0422      \u043f\u043e \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u044b\u043c \u0440\u0430\u0431\u043e\u0442\u0430\u043c     \u043f\u043e \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u0435 \u00abWeb-\u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u00bb <p> \u041e\u0442\u0447\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u043b  \u0421\u0442\u0443\u0434\u0435\u043d\u0442: \u041c\u0430\u043b\u0430\u0435\u0432 \u0421\u0442\u0435\u043f\u0430\u043d  \u0413\u0440\u0443\u043f\u043f\u0430: \u041a33422 \u0424\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442: \u0418\u041a\u0422  \u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c: \u0413\u043e\u0432\u043e\u0440\u043e\u0432 \u0410\u043d\u0442\u043e\u043d </p>      \u0421\u0430\u043d\u043a\u0442-\u041f\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433 2024"},{"location":"lr_1/task_1/","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 1","text":""},{"location":"lr_1/task_1/#_1","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>config.py</code></p> <pre><code>HOST = '127.0.0.1'\nPORT = 8080\nBUFF_SIZE = 1024\n</code></pre> <p><code>server.py</code></p> <pre><code>import socket\n\nfrom config import BUFF_SIZE, HOST, PORT\n\nwith socket.socket(socket.AF_INET, socket.SOCK_DGRAM) as s:\n    s.bind((HOST, PORT))\n    while True:\n        data, addr = s.recvfrom(BUFF_SIZE)\n        print(f\"Received from {addr}: {data.decode()}\")\n        s.sendto(b\"Hello, client!\", addr)\n</code></pre> <p><code>client.py</code></p> <pre><code>import socket\n\nfrom config import BUFF_SIZE, HOST, PORT\n\nwith socket.socket(socket.AF_INET, socket.SOCK_DGRAM) as s:\n    s.sendto(b\"Hello, server!\", (HOST, PORT))\n    data, addr = s.recvfrom(BUFF_SIZE)\n    print(f\"Received from {addr}: {data.decode()}\")\n</code></pre>"},{"location":"lr_1/task_1/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":"<ul> <li> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 UDP: \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 TCP, UDP \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u043c \u0431\u0435\u0437 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438, \u0447\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043c\u0435\u043d\u044c\u0448\u0443\u044e   \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0443 \u0438 \u043c\u0435\u043d\u044c\u0448\u0438\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u043a \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438, \u043d\u043e \u0431\u0435\u0437 \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0438 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0438\u043b\u0438 \u043f\u043e\u0440\u044f\u0434\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439.</p> </li> <li> <p>\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0447\u0435\u0440\u0435\u0437 \u041c\u043e\u0434\u0443\u043b\u044c: \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (\u0430\u0434\u0440\u0435\u0441 \u0445\u043e\u0441\u0442\u0430, \u043f\u043e\u0440\u0442 \u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u0443\u0444\u0435\u0440\u0430) \u0432\u044b\u043d\u0435\u0441\u0435\u043d\u044b \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439   \u043c\u043e\u0434\u0443\u043b\u044c <code>config</code>, \u0447\u0442\u043e \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u0447\u0438\u0442\u0430\u0435\u043c\u043e\u0441\u0442\u044c \u043a\u043e\u0434\u0430 \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0435\u0433\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435.</p> </li> <li> <p>\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u041a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0421\u0435\u0440\u0432\u0435\u0440\u0430:</p> <ul> <li>\u041a\u043b\u0438\u0435\u043d\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \"Hello, server!\" \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430.</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430, \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0435\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0438 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435\u043c \"Hello, client!\".</li> </ul> </li> <li> <p>\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0434\u043b\u044f \u0421\u043e\u043a\u0435\u0442\u043e\u0432: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438 <code>with</code> \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f \u0441\u043e\u043a\u0435\u0442\u0430 \u043f\u043e\u0441\u043b\u0435 \u0432\u044b\u0445\u043e\u0434\u0430   \u0438\u0437 \u0431\u043b\u043e\u043a\u0430 \u043a\u043e\u0434\u0430 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c\u0438 \u0438 \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0443\u0442\u0435\u0447\u043a\u0438.</p> </li> <li> <p>\u041e\u0442\u043b\u0430\u0434\u043e\u0447\u043d\u044b\u0435 \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f: \u0412\u044b\u0432\u043e\u0434 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0430\u0434\u0440\u0435\u0441\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0432 \u043e\u0442\u043b\u0430\u0434\u043a\u0435 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0435   \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c.</p> </li> </ul>"},{"location":"lr_1/task_2/","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 2","text":""},{"location":"lr_1/task_2/#_1","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>config.py</code></p> <pre><code>HOST = '127.0.0.1'\nPORT = 8080\nBUFF_SIZE = 1024\n</code></pre> <p><code>tools.py</code></p> <pre><code>def solve_quadratic_equation(a, b, c) -&gt; float or tuple:\n    d = b ** 2 - 4 * a * c\n    if d &lt; 0:\n        return None\n    elif d == 0:\n        return -b / (2 * a)\n    else:\n        return (-b - d ** 0.5) / (2 * a), (-b + d ** 0.5) / (2 * a)\n</code></pre> <p><code>server.py</code></p> <pre><code>import socket\n\nfrom config import BUFF_SIZE, HOST, PORT\nfrom tools import solve_quadratic_equation\n\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.bind((HOST, PORT))\n    s.listen()\n    while True:\n        conn, addr = s.accept()\n        with conn:\n            print(f'Connected by {addr}')\n            conn.sendall(b'Enter a, b, c: ')\n            data = conn.recv(BUFF_SIZE)\n            data = data.decode()\n            try:\n                a, b, c = map(float, data.split(', '))\n                res = solve_quadratic_equation(a, b, c)\n                match res:\n                    case None:\n                        output = 'No roots'\n                    case float():\n                        output = f'x = {res}'\n                    case tuple():\n                        output = f'x1 = {res[0]:.3f}, x2 = {res[1]:.3f}'\n            except ValueError:\n                output = 'Invalid input'\n            conn.sendall(output.encode())\n</code></pre> <p><code>client.py</code></p> <pre><code>import socket\n\nfrom config import BUFF_SIZE, HOST, PORT\n\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.connect((HOST, PORT))\n\n    data = s.recv(BUFF_SIZE)\n    print(data.decode())\n\n    data = input()\n    s.sendall(data.encode())\n\n    data = s.recv(BUFF_SIZE)\n    print(data.decode())\n</code></pre>"},{"location":"lr_1/task_2/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":"<ul> <li> <p>TCP \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435: \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u0430 \u0441 UDP, \u0437\u0434\u0435\u0441\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f TCP \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442   \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u0440\u044f\u0434\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439.</p> </li> <li> <p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u041a\u0432\u0430\u0434\u0440\u0430\u0442\u043d\u043e\u0433\u043e \u0423\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f: \u0424\u0443\u043d\u043a\u0446\u0438\u044f <code>solve_quadratic_equation</code> \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442 \u0434\u0438\u0441\u043a\u0440\u0438\u043c\u0438\u043d\u0430\u043d\u0442 \u0438 \u043a\u043e\u0440\u043d\u0438 \u0443\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f,   \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044f \u0440\u0430\u0437\u043d\u044b\u0435 \u043e\u0442\u0432\u0435\u0442\u044b \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0434\u0438\u0441\u043a\u0440\u0438\u043c\u0438\u043d\u0430\u043d\u0442\u0430.</p> </li> <li> <p>\u041f\u0440\u043e\u0441\u0442\u043e\u0439 \u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441: \u0421\u0435\u0440\u0432\u0435\u0440 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b \u0443\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 <code>a, b, c</code>, \u0447\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442   \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043f\u043e\u043d\u044f\u0442\u043d\u044b\u043c \u0438 \u043f\u0440\u043e\u0441\u0442\u044b\u043c.</p> </li> <li> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u041c\u0430\u0442\u0447\u0438\u043d\u0433\u0430 \u041f\u043e \u0428\u0430\u0431\u043b\u043e\u043d\u0443: \u0412 Python 3.10 \u0438 \u0432\u044b\u0448\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 <code>match</code> \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445   \u0441\u043b\u0443\u0447\u0430\u0435\u0432 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438. \u042d\u0442\u043e \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u043a\u043e\u0434 \u0438 \u0434\u0435\u043b\u0430\u0435\u0442 \u0435\u0433\u043e \u0431\u043e\u043b\u0435\u0435 \u0447\u0438\u0442\u0430\u0435\u043c\u044b\u043c.</p> </li> <li> <p>\u0414\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u041a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439: \u041f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0431\u0430\u0439\u0442\u043e\u0432\u043e\u043c   \u0444\u043e\u0440\u043c\u0430\u0442\u0435, \u0447\u0442\u043e \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0438\u0445 \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c.</p> </li> <li> <p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439: \u0421\u0435\u0440\u0432\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 <code>ValueError</code> \u0434\u043b\u044f \u0441\u043b\u0443\u0447\u0430\u0435\u0432, \u043a\u043e\u0433\u0434\u0430 \u0432\u0432\u043e\u0434 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442   \u043e\u0436\u0438\u0434\u0430\u0435\u043c\u043e\u043c\u0443 \u0444\u043e\u0440\u043c\u0430\u0442\u0443, \u0447\u0442\u043e \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0435\u0433\u043e \u0430\u0432\u0430\u0440\u0438\u0439\u043d\u043e\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435.</p> </li> </ul>"},{"location":"lr_1/task_3/","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 3","text":""},{"location":"lr_1/task_3/#_1","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>config.py</code></p> <pre><code>HOST = '127.0.0.1'\nPORT = 8080\n</code></pre> <p><code>index.html</code></p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Hello, world!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\nHello, world!\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p><code>server.py</code></p> <pre><code>import socket\n\nfrom config import HOST, PORT\n\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.bind((HOST, PORT))\n    s.listen(1)\n    while True:\n        conn, addr = s.accept()\n        print('Connected by', addr)\n\n        with open('index.html', 'rb') as f:\n            data = f.read()\n\n        conn.sendall(\n            b'HTTP/1.1 200 OK\\n'\n            b'Content-Type: text/html\\n'\n            b'Connection: close\\n\\n'\n            + data\n        )\n\n# http://localhost:8080/\n</code></pre>"},{"location":"lr_1/task_3/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":"<ul> <li> <p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0421\u043e\u043a\u0435\u0442\u0430: \u0421\u0435\u0440\u0432\u0435\u0440 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d \u043d\u0430 \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u043d\u0438\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 <code>127.0.0.1</code> \u0438 \u043f\u043e\u0440\u0442\u0443 <code>8080</code>, \u0447\u0442\u043e   \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0442\u0438\u043f\u0438\u0447\u043d\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439 \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0432\u0435\u0431-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439.</p> </li> <li> <p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0417\u0430\u043f\u0440\u043e\u0441\u043e\u0432: \u041f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u0447\u0438\u0442\u0430\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0444\u0430\u0439\u043b\u0430 <code>index.html</code> \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0435\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0432   \u043e\u0442\u0432\u0435\u0442, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 HTTP-\u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043e \u0442\u043e\u043c, \u0447\u0442\u043e \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u043e\u0436\u0438\u0434\u0430\u0442\u044c HTML-\u043a\u043e\u043d\u0442\u0435\u043d\u0442.</p> </li> <li> <p>HTML: \u041f\u0440\u0438\u043c\u0435\u0440 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0431\u0430\u0437\u043e\u0432\u0443\u044e HTML-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0441 \u043f\u0440\u043e\u0441\u0442\u044b\u043c \u043f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435\u043c, \u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0438\u0440\u0443\u044e\u0449\u0443\u044e, \u043a\u0430\u043a \u043c\u043e\u0436\u043d\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u0442\u044c   \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0432\u0435\u0431-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b.</p> </li> <li> <p>HTTP-\u041e\u0442\u0432\u0435\u0442: \u0421\u0435\u0440\u0432\u0435\u0440 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u0439 HTTP-\u043e\u0442\u0432\u0435\u0442, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0442\u0430\u0442\u0443\u0441\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 (<code>HTTP/1.1 200 OK</code>), \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438,   \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0449\u0438\u0435 \u043d\u0430 \u0442\u0438\u043f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e (<code>Content-Type: text/html</code>) \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435\u043c (<code>Connection: close</code>), \u0447\u0442\u043e   \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0435\u0439 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u043e\u0439 \u0434\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435.</p> </li> <li> <p>\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0421\u043e\u043a\u0435\u0442\u0430: \u0412 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u044e\u0449\u0438\u0439 \u0441\u043e\u043a\u0435\u0442, \u0447\u0442\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f   \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e. \u042d\u0442\u043e \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u043a\u043e\u0434, \u043d\u043e \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043b\u0430\u0441\u044c \u0431\u044b \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c   \u0438\u043b\u0438 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c.</p> </li> <li> <p>\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0432 \u0411\u0430\u0439\u0442\u0430\u0445: \u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0431\u0430\u0439\u0442\u043e\u0432\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435, \u0447\u0442\u043e \u043f\u043e\u0434\u0447\u0435\u0440\u043a\u0438\u0432\u0430\u0435\u0442 \u043d\u0438\u0437\u043a\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u0443\u044e   \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 \u0441\u0435\u0442\u0435\u0432\u044b\u043c\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\u043c\u0438 \u0432 Python.</p> </li> </ul>"},{"location":"lr_1/task_4/","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 4","text":""},{"location":"lr_1/task_4/#_1","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>config.py</code></p> <pre><code>HOST = '127.0.0.1'\nPORT = 8080\nBUFF_SIZE = 1024\n</code></pre> <p><code>server.py</code></p> <pre><code>import socket\nimport threading\n\nfrom config import BUFF_SIZE, HOST, PORT\n\nclients = {}\nlock = threading.Lock()\n\n\ndef handle_client(conn, addr):\n    name = None\n    try:\n        conn.sendall(b'Enter your name: ')\n        name = conn.recv(BUFF_SIZE).decode()\n\n        with lock:\n            clients[conn] = name\n\n        print(f'New connection: {name} {addr}')\n        broadcast_message(f'{name} joined the chat', conn)\n\n        while True:\n            data = conn.recv(BUFF_SIZE)\n\n            if not data:\n                print(f\"{name} has disconnected.\")\n                break\n\n            print(f\"Message from {name}: {data.decode()}\")\n            broadcast_message(f'{name}: {data.decode()}', conn)\n    except ConnectionResetError:\n        print(f\"Connection reset by {name}.\")\n    finally:\n        if name:\n            with lock:\n                if conn in clients:\n                    del clients[conn]\n            conn.close()\n            broadcast_message(f'{name} has left the chat', conn)\n\n\ndef broadcast_message(message, sender_conn):\n    with lock:\n        for client in clients:\n            if client != sender_conn:\n                client.sendall(message.encode())\n\n\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.bind((HOST, PORT))\n    s.listen()\n    while True:\n        conn, addr = s.accept()\n        threading.Thread(target=handle_client, args=(conn, addr)).start()\n</code></pre> <p><code>client.py</code></p> <pre><code>import socket\nimport threading\n\nfrom config import BUFF_SIZE, HOST, PORT\n\n\ndef receive_messages(sock):\n    while True:\n        try:\n            message = sock.recv(BUFF_SIZE).decode()\n            print(message)\n        except WindowsError:\n            break\n\n\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.connect((HOST, PORT))\n\n    threading.Thread(target=receive_messages, args=(s,)).start()\n\n    while True:\n        try:\n            message = input()\n            s.sendall(message.encode('utf-8'))\n        except KeyboardInterrupt:\n            break\n</code></pre>"},{"location":"lr_1/task_4/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":"<ul> <li> <p>\u041c\u043d\u043e\u0433\u043e\u043f\u043e\u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 (<code>threading.Thread</code>) \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445   \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044f \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u044b\u0439 \u043f\u0440\u0438\u0435\u043c \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0443 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439.</p> </li> <li> <p>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u041a\u043b\u0438\u0435\u043d\u0442\u0430\u043c\u0438: \u0421\u0435\u0440\u0432\u0435\u0440 \u0445\u0440\u0430\u043d\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u0445 \u0432 \u0441\u043b\u043e\u0432\u0430\u0440\u0435 <code>clients</code>, \u0433\u0434\u0435 \u043a\u043b\u044e\u0447\u043e\u043c \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f   \u043e\u0431\u044a\u0435\u043a\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f, \u0430 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c - \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u042d\u0442\u043e \u043e\u0431\u043b\u0435\u0433\u0447\u0430\u0435\u0442 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c, \u043a\u0440\u043e\u043c\u0435   \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f.</p> </li> <li> <p>\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 <code>lock</code> (<code>threading.Lock()</code>) \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043e\u0431\u0449\u0438\u0445   \u0434\u0430\u043d\u043d\u044b\u0445 (<code>clients</code>), \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u0433\u043e\u043d\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u0435 \u0438\u0437 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432.</p> </li> <li> <p>\u041f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0438 \u0418\u043c\u0435\u043d\u0430 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439: \u041f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a \u0447\u0430\u0442\u0443 \u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0432\u0432\u0435\u0441\u0442\u0438 \u0438\u043c\u044f, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0437\u0430\u0442\u0435\u043c   \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u0445 \u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f\u0445 \u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438/\u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438.</p> </li> <li> <p>\u0411\u0435\u0441\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u044b\u0439 \u041f\u0440\u0438\u0435\u043c \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439: \u041d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u0442\u043e\u043a \u0434\u043b\u044f \u043f\u0440\u0438\u0435\u043c\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044f   \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0441\u0432\u043e\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u043d\u0435 \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u0440\u0438\u0435\u043c\u0430 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445.</p> </li> <li> <p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439: \u041a\u043e\u0434 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a <code>ConnectionResetError</code> \u0438 <code>WindowsError</code>, \u0434\u043b\u044f   \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u043e\u0442\u043e\u043a\u0430 \u043f\u0440\u0438 \u043d\u0435\u043e\u0436\u0438\u0434\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u0440\u044b\u0432\u0430\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f.</p> </li> </ul>"},{"location":"lr_1/task_5/","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 1","text":""},{"location":"lr_1/task_5/#_1","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>config.py</code></p> <pre><code>HOST = '127.0.0.1'\nPORT = 8080\nBUFF_SIZE = 1024\n</code></pre> <p><code>server.py</code></p> <pre><code>import socket\nimport threading\nfrom http.client import responses\nfrom urllib.parse import parse_qs, unquote_plus\n\nfrom config import BUFF_SIZE, HOST, PORT\n\n\nclass GradesServer:\n    def __init__(self, host, port, buff_size):\n        self.host = host\n        self.port = port\n        self.buff_size = buff_size\n        self.socket = None\n        self.grades = {}\n        self.lock = threading.Lock()\n\n    def start(self):\n        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        self.socket.bind((self.host, self.port))\n        self.socket.listen()\n\n        print(f\"Server started on http://{self.host}:{self.port}\")\n\n        while True:\n            conn, addr = self.socket.accept()\n            threading.Thread(target=self.handle_client, args=(conn,)).start()\n\n    def handle_client(self, conn):\n        request = self.read_request(conn)\n        try:\n            headers, body = request.split('\\r\\n\\r\\n', 1)\n            request_line = headers.splitlines()[0]\n            method, path, _ = request_line.split()\n\n            match method:\n                case 'GET':\n                    response = self.handle_get(path)\n                case 'POST':\n                    response = self.handle_post(path, body)\n                case _:\n                    response = self.http_response(405, \"Method Not Allowed\")\n        except Exception as e:\n            response = self.http_response(400, f\"Bad Request: {e}\")\n\n        conn.sendall(response)\n        conn.close()\n\n    def read_request(self, conn):\n        request = \"\"\n        while True:\n            part = conn.recv(self.buff_size).decode()\n            request += part\n            if '\\r\\n\\r\\n' in part:\n                break\n        return request\n\n    def handle_get(self, path):\n        match path:\n            case '/grades':\n                content = self.grades_html()\n                return self.http_response(200, content, content_type='text/html')\n            case _:\n                return self.http_response(404, \"Not Found\")\n\n    def handle_post(self, path, body):\n        match path:\n            case '/submit-grade':\n                data = self.parse_form_data(body)\n                discipline = data.get('discipline')\n                grade = data.get('grade')\n                if discipline and grade:\n                    with self.lock:\n                        self.grades.setdefault(discipline, []).append(grade)\n                    return self.handle_get('/grades')\n                else:\n                    return self.http_response(400, \"Bad Request\")\n            case _:\n                return self.http_response(404, \"Not Found\")\n\n    @staticmethod\n    def http_response(status_code, body, headers=None, content_type='text/plain'):\n        response_line = f\"HTTP/1.1 {status_code} {responses[status_code]}\\r\\n\"\n        headers = headers or {}\n        headers['Content-Type'] = content_type\n        headers['Content-Length'] = len(body.encode())\n        header_lines = \"\\r\\n\".join(f\"{key}: {value}\" for key, value in headers.items())\n        return (response_line + header_lines + \"\\r\\n\\r\\n\" + body).encode()\n\n    @staticmethod\n    def parse_form_data(body):\n        params = parse_qs(body)\n        return {k: unquote_plus(v[0]) if v else None for k, v in params.items()}\n\n    def grades_html(self):\n        content = ('&lt;!DOCTYPE html&gt;'\n                   '&lt;html lang=\"en\"&gt;'\n                   '&lt;head&gt;'\n                   '&lt;meta charset=\"UTF-8\"&gt;&lt;title&gt;Grades&lt;/title&gt;'\n                   '&lt;/head&gt;'\n                   '&lt;body&gt;')\n\n        with self.lock:\n            for discipline, grades in self.grades.items():\n                content += f\"&lt;h2&gt;{discipline}&lt;/h2&gt;&lt;ul&gt;\"\n                for grade in grades:\n                    content += f\"&lt;li&gt;{grade}&lt;/li&gt;\"\n                content += \"&lt;/ul&gt;\"\n        content += \"&lt;/body&gt;&lt;/html&gt;\"\n        return content\n\n\nif __name__ == '__main__':\n    server = GradesServer(HOST, PORT, BUFF_SIZE)\n    server.start()\n</code></pre>"},{"location":"lr_1/task_5/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":"<ul> <li> <p>\u041c\u043d\u043e\u0433\u043e\u043f\u043e\u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 <code>threading</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432   \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044f \u0432\u044b\u0441\u043e\u043a\u0443\u044e \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u043e\u0442\u0437\u044b\u0432\u0447\u0438\u0432\u043e\u0441\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430.</p> </li> <li> <p>\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u0430\u043c\u0438: \u0421\u0435\u0440\u0432\u0435\u0440 \u0441\u043f\u043e\u0441\u043e\u0431\u0435\u043d \u0440\u0430\u0441\u043f\u043e\u0437\u043d\u0430\u0432\u0430\u0442\u044c \u043c\u0435\u0442\u043e\u0434\u044b HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (GET \u0438 POST), \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u0440\u0435\u0430\u0433\u0438\u0440\u0443\u044f \u043d\u0430 \u043d\u0438\u0445   \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0443\u0442\u0438 \u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430.</p> </li> <li> <p>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435 \u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0414\u0430\u043d\u043d\u044b\u0445: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043e\u043a (<code>threading.Lock</code>) \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u043e\u0431\u0449\u0438\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 (\u0441\u043f\u0438\u0441\u043e\u043a   \u043e\u0446\u0435\u043d\u043e\u043a) \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u0433\u043e\u043d\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438.</p> </li> <li> <p>\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 HTML-\u043e\u0442\u0432\u0435\u0442\u043e\u0432: \u0421\u0435\u0440\u0432\u0435\u0440 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438 \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 HTML-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u043e\u0446\u0435\u043d\u043e\u043a, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f   \u0434\u0430\u043d\u043d\u044b\u0435, \u0445\u0440\u0430\u043d\u044f\u0449\u0438\u0435\u0441\u044f \u0432 \u043f\u0430\u043c\u044f\u0442\u0438. \u042d\u0442\u043e \u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442, \u043a\u0430\u043a \u043c\u043e\u0436\u043d\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u0432\u0435\u0431-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0431\u0435\u0437 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0438\u0445   \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u043e\u0432.</p> </li> <li> <p>\u041f\u0430\u0440\u0441\u0438\u043d\u0433 \u0422\u0435\u043b\u0430 \u0417\u0430\u043f\u0440\u043e\u0441\u0430: \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 POST-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433 \u0442\u0435\u043b\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0434\u043b\u044f \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0444\u043e\u0440\u043c\u044b,   \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u043e\u0446\u0435\u043d\u043a\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0447\u0435\u0440\u0435\u0437 \u0432\u0435\u0431-\u0444\u043e\u0440\u043c\u0443.</p> </li> <li> <p>\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0417\u0430\u043f\u0440\u043e\u0441\u043e\u0432: \u0421\u0435\u0440\u0432\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043f\u0440\u043e\u0441\u0442\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043d\u0430   \u043e\u0441\u043d\u043e\u0432\u0435 URL-\u043f\u0443\u0442\u0438, \u0447\u0442\u043e \u043e\u0431\u043b\u0435\u0433\u0447\u0430\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0438 \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u043a\u043e\u0434\u0430.</p> </li> </ul>"},{"location":"lr_2/common/","title":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c","text":""},{"location":"lr_2/common/#_2","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>common/views.py</code></p> <pre><code>from django.utils import timezone\nfrom django.views.generic import TemplateView\n\nfrom tours import models\n\n\nclass IndexView(TemplateView):\n    template_name = 'common/index.html'\n    tours_on_page: int = 6\n\n    def get_context_data(self, **kwargs):\n        context = super().get_context_data(**kwargs)\n        context['recommended_tours'] = models.Tour.objects\n        .filter(start_date__gte=timezone.localdate())\n        .order_by('start_date')[:self.tours_on_page]\n\n        return context\n</code></pre> <p><code>common/urls.py</code></p> <pre><code>from django.urls import path\n\nfrom . import views\n\nurlpatterns = [\n    path('', views.IndexView.as_view(), name='home')\n]\n</code></pre>"},{"location":"lr_2/common/#_3","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":""},{"location":"lr_2/common/#templateview","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 <code>TemplateView</code>","text":"<ul> <li>\u0428\u0430\u0431\u043b\u043e\u043d: \u0414\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u043b\u0430\u0441\u0441 <code>TemplateView</code>, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u043b\u0435\u0433\u043a\u043e \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c   \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0441 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u043e\u043c.</li> <li>\u041a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430: \u0427\u0435\u0440\u0435\u0437 \u043c\u0435\u0442\u043e\u0434 <code>get_context_data</code>, \u043a\u043b\u0430\u0441\u0441 <code>IndexView</code> \u0434\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0448\u0430\u0431\u043b\u043e\u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043e   \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c\u044b\u0445 \u0442\u0443\u0440\u0430\u0445.</li> </ul>"},{"location":"lr_2/common/#_4","title":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0438 \u041e\u0442\u0431\u043e\u0440 \u0422\u0443\u0440\u043e\u0432","text":"<ul> <li>\u0410\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0422\u0443\u0440\u043e\u0432: \u0412 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0448\u0430\u0431\u043b\u043e\u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0442\u0443\u0440\u044b, \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0435\u0441\u044f \u0441 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0434\u0430\u0442\u044b, \u0447\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442   \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438.</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0422\u0443\u0440\u043e\u0432: \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c\u044b\u0445 \u0442\u0443\u0440\u043e\u0432 (<code>tours_on_page</code>), \u0447\u0442\u043e   \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439.</li> </ul>"},{"location":"lr_2/common/#_5","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0422\u0443\u0440\u043e\u0432: \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u043a\u043b\u0430\u0441\u0441\u0430 <code>tours_on_page</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e   \u0442\u0443\u0440\u043e\u0432, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c\u044b\u0445 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435, \u0447\u0442\u043e \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0430\u0434\u0430\u043f\u0442\u0430\u0446\u0438\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043f\u043e\u0434 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0434\u0438\u0437\u0430\u0439\u043d\u044b \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435   \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f.</li> <li>\u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0417\u0430\u043f\u0440\u043e\u0441\u043e\u0432: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 <code>order_by</code> \u0441 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u0441\u0440\u0435\u0437\u043e\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0434\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0447\u0438\u0441\u043b\u0430   \u0442\u0443\u0440\u043e\u0432 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b.</li> <li>\u0423\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u044b\u0439 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u041e\u043f\u044b\u0442: \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u0440\u0435\u0434\u0441\u0442\u043e\u044f\u0449\u0438\u0445 \u0442\u0443\u0440\u0430\u0445 \u0441\u0440\u0430\u0437\u0443 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439   \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u043e\u043f\u044b\u0442, \u0434\u0435\u043b\u0430\u044f \u0441\u0430\u0439\u0442 \u0431\u043e\u043b\u0435\u0435 \u043f\u0440\u0438\u0432\u043b\u0435\u043a\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0434\u043b\u044f \u043f\u043e\u0442\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432.</li> </ul>"},{"location":"lr_2/tours/","title":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0442\u0443\u0440\u0430\u043c\u0438","text":""},{"location":"lr_2/tours/#_2","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>tours/views.py</code></p> <pre><code>from django.contrib.auth.mixins import LoginRequiredMixin\nfrom django.db.models import Q\nfrom django.utils import timezone\nfrom django.views import View\nfrom django.views.generic import DetailView, ListView\n\nfrom . import forms, mixins, models\n\n\nclass TourListView(ListView):\n    model = models.Tour\n    paginate_by = 5\n    template_name = 'tours/explore.html'\n\n    def get_queryset(self):\n        queryset = super().get_queryset().filter(start_date__gt=timezone.localdate())\n\n        search_query = self.request.GET.get('search', '')\n\n        if search_query:\n            queryset = queryset.filter(\n                Q(name__icontains=search_query) |\n                Q(country__icontains=search_query) |\n                Q(description__icontains=search_query)\n            )\n\n        queryset = queryset.order_by('country')\n\n        return queryset\n\n\nclass TourDetailView(DetailView):\n    model = models.Tour\n    template_name = 'tours/tour_detail.html'\n\n\nclass AddReviewView(LoginRequiredMixin, mixins.CreateObjectMixin, View):\n    form_class = forms.ReviewForm\n    model = models.Tour\n    related_name = 'tour'\n\n\nclass AddBookingView(LoginRequiredMixin, mixins.CreateObjectMixin, View):\n    form_class = forms.BookingForm\n    model = models.Tour\n    related_name = 'tour'\n</code></pre> <p><code>tours/urls.py</code></p> <pre><code>from django.urls import path\n\nfrom . import views\n\nurlpatterns = [\n    path('', views.TourListView.as_view(), name='explore'),\n    path('&lt;int:pk&gt;/', views.TourDetailView.as_view(), name='tour_detail'),\n    path('&lt;int:pk&gt;/add-review', views.AddReviewView.as_view(), name='add_review'),\n    path('&lt;int:pk&gt;/book', views.AddBookingView.as_view(), name='add_booking'),\n]\n</code></pre>"},{"location":"lr_2/tours/#_3","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":""},{"location":"lr_2/tours/#tourlistview","title":"\u0421\u043f\u0438\u0441\u043e\u043a \u0422\u0443\u0440\u043e\u0432 (<code>TourListView</code>)","text":"<ul> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0438 \u041f\u043e\u0438\u0441\u043a: \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e, \u0441\u0442\u0440\u0430\u043d\u0435 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044e \u0441   \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c <code>Q</code>-\u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u0441\u043e\u0441\u0442\u0430\u0432\u043d\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432.</li> <li>\u041f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044f: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044f \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0443\u0440\u043e\u0432, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432 5 \u0442\u0443\u0440\u043e\u0432 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443.</li> </ul>"},{"location":"lr_2/tours/#tourdetailview","title":"\u0414\u0435\u0442\u0430\u043b\u044c\u043d\u044b\u0439 \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0422\u0443\u0440\u0430 (<code>TourDetailView</code>)","text":"<ul> <li>\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0414\u0435\u0442\u0430\u043b\u0435\u0439: \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0443\u0440\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435, \u0434\u0430\u0442\u0443 \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b.</li> </ul>"},{"location":"lr_2/tours/#addreviewview","title":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u041e\u0442\u0437\u044b\u0432\u0430 (<code>AddReviewView</code>)","text":"<ul> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0414\u043e\u0441\u0442\u0443\u043f\u0430: \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u0441   \u043f\u043e\u043c\u043e\u0449\u044c\u044e <code>LoginRequiredMixin</code>.</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u041c\u0438\u043a\u0441\u0438\u043d\u043e\u0432: \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u044b \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043c\u0438\u043a\u0441\u0438\u043d\u044b \u0434\u043b\u044f \u043e\u0431\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u043a\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0443\u043f\u0440\u043e\u0449\u0430\u044f   \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043a \u0442\u0443\u0440\u0430\u043c.</li> </ul>"},{"location":"lr_2/tours/#addbookingview","title":"\u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0422\u0443\u0440\u0430 (<code>AddBookingView</code>)","text":"<ul> <li>\u0424\u043e\u0440\u043c\u0430 \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: \u0418\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0444\u043e\u0440\u043c\u0430 \u0434\u043b\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0443\u0440\u0430, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</li> <li>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u041e\u0431\u044a\u0435\u043a\u0442\u043e\u0432: \u0410\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044e \u043e\u0442\u0437\u044b\u0432\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043c\u0438\u043a\u0441\u0438\u043d\u043e\u0432 \u0434\u043b\u044f \u0443\u043f\u0440\u043e\u0449\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430   \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> </ul>"},{"location":"lr_2/tours/#_4","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u041c\u0438\u043a\u0441\u0438\u043d\u044b \u0434\u043b\u044f \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u041e\u0431\u044a\u0435\u043a\u0442\u043e\u0432: \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u043c\u0438\u043a\u0441\u0438\u043d\u043e\u0432 \u0434\u043b\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u043a\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f   \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0434\u0430 \u0438 \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u0435\u0433\u043e \u0447\u0438\u0442\u0430\u0435\u043c\u043e\u0441\u0442\u044c.</li> <li>\u0413\u0438\u0431\u043a\u0430\u044f \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u041f\u043e\u0438\u0441\u043a\u0430: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 <code>Q</code>-\u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u043f\u043e\u043b\u044f\u043c \u043c\u043e\u0434\u0435\u043b\u0438 <code>Tour</code>   \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0433\u0438\u0431\u043a\u043e\u0441\u0442\u044c \u0438 \u043c\u043e\u0449\u043d\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445.</li> <li>\u0417\u0430\u0449\u0438\u0442\u0430 \u0414\u043e\u0441\u0442\u0443\u043f\u0430: \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 <code>LoginRequiredMixin</code> \u0434\u043b\u044f \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u043c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c \u043f\u043e\u0432\u044b\u0448\u0430\u0435\u0442   \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</li> <li>\u0423\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u044b\u0439 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u041e\u043f\u044b\u0442: \u041f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0443\u0440\u043e\u0432 \u0438 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u043e\u0438\u0441\u043a \u0437\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u043b\u0443\u0447\u0448\u0430\u044e\u0442   \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u043e\u043f\u044b\u0442, \u0434\u0435\u043b\u0430\u044f \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0431\u043e\u043b\u0435\u0435 \u0434\u0440\u0443\u0436\u0435\u043b\u044e\u0431\u043d\u044b\u043c.</li> </ul>"},{"location":"lr_2/users/","title":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c","text":""},{"location":"lr_2/users/#_2","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>users/views.py</code></p> <pre><code>from common import handlers\nfrom django.contrib.auth import authenticate, get_user_model, login, update_session_auth_hash\nfrom django.contrib.auth.mixins import LoginRequiredMixin\nfrom django.contrib.auth.views import LogoutView\nfrom django.core.exceptions import ValidationError\nfrom django.http import JsonResponse\nfrom django.shortcuts import get_object_or_404\nfrom django.urls import reverse_lazy\nfrom django.views import View\nfrom django.views.generic import ListView, TemplateView\nfrom tours import models as tour_models\n\nfrom . import forms\n\nUser = get_user_model()\n\n\nclass LogoutView(LogoutView):\n    next_page = reverse_lazy('home')\n\n\nclass RegisterView(View):\n    def post(self, request, *args, **kwargs):\n        email = request.POST.get('email')\n        password = request.POST.get('password')\n        confirm_password = request.POST.get('confirm_password')\n\n        if User.objects.filter(email=email).exists():\n            return JsonResponse({'error': 'Email already in use'}, status=400)\n\n        if password != confirm_password:\n            return JsonResponse({'error': 'Passwords do not match'}, status=400)\n\n        User.objects.create_user(email=email, password=password)\n\n        return JsonResponse({'success': True})\n\n\nclass LoginView(View):\n    def post(self, request, *args, **kwargs):\n        email = request.POST.get('email')\n        password = request.POST.get('password')\n        user = authenticate(request, username=email, password=password)\n\n        if user is not None:\n            if user.is_active:\n                login(request, user)\n                return JsonResponse({'success': True})\n            else:\n                return JsonResponse({'error': 'Account is disabled'}, status=403)\n\n        return JsonResponse({'error': 'Invalid credentials'}, status=400)\n\n\nclass SettingsView(LoginRequiredMixin, TemplateView):\n    template_name = 'users/settings.html'\n\n    def get_context_data(self, **kwargs):\n        context = super().get_context_data(**kwargs)\n        context['profile_form'] = forms.UpdateProfileForm(instance=self.request.user)\n        context['password_form'] = forms.PasswordChangeForm(user=self.request.user)\n\n        return context\n\n\nclass UpdateProfileView(LoginRequiredMixin, View):\n    form_class = forms.UpdateProfileForm\n\n    def post(self, request, *args, **kwargs):\n        form = self.form_class(request.POST, instance=request.user)\n\n        if form.is_valid():\n            form.save()\n            return JsonResponse({'success': True})\n\n        error_message = handlers.handle_form_errors(form)\n\n        return JsonResponse({'error': error_message}, status=400)\n\n\nclass ChangePasswordView(LoginRequiredMixin, View):\n    form_class = forms.PasswordChangeForm\n\n    def post(self, request, *args, **kwargs):\n        form = self.form_class(request.user, request.POST)\n\n        if form.is_valid():\n            user = form.save(commit=False)\n            update_session_auth_hash(request, user)\n            user.save()\n            return JsonResponse({'success': True})\n\n        error_message = handlers.handle_form_errors(form)\n\n        return JsonResponse({'error': error_message}, status=400)\n\n\nclass BookingsView(LoginRequiredMixin, ListView):\n    model = tour_models.Booking\n    template_name = 'users/bookings.html'\n    context_object_name = 'bookings'\n\n    def get_queryset(self):\n        user = self.request.user\n        if user.is_active:\n            return self.model.objects.filter(user=user).order_by('-booking_date').select_related('tour')\n        else:\n            return self.objects.none()\n\n\nclass CancelBookingView(LoginRequiredMixin, View):\n    form_class = forms.CancelBookingForm\n\n    def post(self, request, *args, **kwargs):\n        pk = request.POST.get('booking_id')\n        booking = get_object_or_404(tour_models.Booking, pk=pk, user=request.user)\n        form = self.form_class(booking=booking)\n\n        try:\n            form.cancel_booking(request.user)\n            return JsonResponse({'success': True})\n        except ValidationError as e:\n            error_message = e.messages[0]\n            return JsonResponse({'error': error_message}, status=400)\n</code></pre> <p><code>users/urls.py</code></p> <pre><code>from django.urls import path\n\nfrom . import views\n\nurlpatterns = [\n    path('logout/', views.LogoutView.as_view(), name='logout'),\n    path('login/', views.LoginView.as_view(), name='login'),\n    path('register/', views.RegisterView.as_view(), name='register'),\n\n    path('settings/', views.SettingsView.as_view(), name='settings'),\n    path('settings/update-profile/', views.UpdateProfileView.as_view(), name='update_profile'),\n    path('settings/change-password/', views.ChangePasswordView.as_view(), name='change_password'),\n\n    path('bookings/', views.BookingsView.as_view(), name='bookings'),\n    path('bookings/cancel', views.CancelBookingView.as_view(), name='cancel_booking'),\n]\n</code></pre>"},{"location":"lr_2/users/#_3","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041c\u043e\u043c\u0435\u043d\u0442\u044b","text":""},{"location":"lr_2/users/#_4","title":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0438 \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f (<code>RegisterView</code>): \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c email \u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f \u0441 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435\u043c. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u0443\u0441\u043f\u0435\u0445\u0430   \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c.</li> <li>\u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f (<code>LoginView</code>): \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u044e\u0442\u0441\u044f \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u0443\u0441\u043f\u0435\u0445\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432\u0445\u043e\u0434\u0438\u0442 \u0432   \u0441\u0438\u0441\u0442\u0435\u043c\u0443.</li> </ul>"},{"location":"lr_2/users/#_5","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u041f\u0440\u043e\u0444\u0438\u043b\u0435\u043c","text":"<ul> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u041f\u0440\u043e\u0444\u0438\u043b\u044f (<code>SettingsView</code>): \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f.</li> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u0440\u043e\u0444\u0438\u043b\u044f (<code>UpdateProfileView</code>): \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u041f\u0430\u0440\u043e\u043b\u044f (<code>ChangePasswordView</code>): \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u044c, \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u044f \u0445\u044d\u0448 \u0441\u0435\u0441\u0441\u0438\u0438 \u0434\u043b\u044f   \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0432\u044b\u0445\u043e\u0434\u0430 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</li> </ul>"},{"location":"lr_2/users/#_6","title":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\u043c\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 (<code>BookingsView</code>): \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u043e\u0442\u043c\u0435\u043d\u044b.</li> <li>\u041e\u0442\u043c\u0435\u043d\u0430 \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (<code>CancelBookingView</code>): \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.</li> </ul>"},{"location":"lr_2/users/#_7","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u041c\u0438\u043a\u0441\u0438\u043d <code>LoginRequiredMixin</code>: \u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c.</li> <li>AJAX-\u043e\u0442\u0432\u0435\u0442\u044b: \u0412\u0441\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u0444\u043e\u0440\u043c\u0430\u043c\u0438 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 AJAX, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044f JSON-\u043e\u0442\u0432\u0435\u0442\u044b, \u0447\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0431\u043e\u043b\u0435\u0435   \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u043d\u043e\u0435 \u0438 \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c.</li> <li>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0424\u043e\u0440\u043c: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0445 \u0444\u043e\u0440\u043c \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0442\u0430\u043a\u0438\u0445 \u043a\u0430\u043a \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u0438   \u043e\u0442\u043c\u0435\u043d\u0430 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439.</li> <li>\u041f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043e\u043a \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0433\u043e\u043d\u043e\u043a \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul>"},{"location":"lr_3/lr_3_1/prac_1/","title":"Prac_1","text":""},{"location":"lr_3/lr_3_1/prac_1/#django","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0410\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u0438 \u0410\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 \u0432 Django","text":"<p>\u0421\u043a\u0440\u0438\u043f\u0442 \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u0430\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432, \u0438\u0445 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 \u0438 \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0439, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0441\u0432\u044f\u0437\u0438 \u043c\u0435\u0436\u0434\u0443 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430\u043c\u0438 \u0438 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f\u043c\u0438.</p>"},{"location":"lr_3/lr_3_1/prac_1/#_1","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u0421\u043a\u0440\u0438\u043f\u0442\u0430","text":"<pre><code>import random\nfrom datetime import date, timedelta\nfrom .models import Driver, Car, DriverLicense, Owning\n\n\ndef random_date(start, end):\n    return start + timedelta(\n        days=random.randint(0, int((end - start).days))\n    )\n\n\nfor i in range(1, 8):\n    driver = Driver.objects.create_user(\n        username=f'driver{i}',\n        email=f'driver{i}@example.com',\n        password='password123',\n        birth_date=random_date(date(1960, 1, 1), date(2000, 12, 31)),\n        passport_number=f'AB12345{i}',\n        home_address=f'123 Main St, City {i}',\n        nationality='Country'\n    )\n\n    DriverLicense.objects.create(\n        id_car_owner=driver,\n        type='B',\n        date_of_issue=random_date(date(2000, 1, 1), date.today())\n    )\n\ncars = []\nfor j in range(1, 7):\n    car = Car.objects.create(\n        state_number=f'XYZ123{j}',\n        brand='BrandName',\n        model=f'Model{j}',\n        color='Blue'\n    )\n    cars.append(car)\n\nfor driver in Driver.objects.all():\n    owned_cars = random.sample(cars, random.randint(1, 3))\n    for car in owned_cars:\n        Owning.objects.create(\n            id_car_owner=driver,\n            id_car=car,\n            start_date=random_date(date(2010, 1, 1), date.today())\n        )\n\nfor driver in Driver.objects.all():\n    print(f'Driver: {driver.username}')\n    for owning in Owning.objects.filter(id_car_owner=driver):\n        print(f'  Car: {owning.id_car.state_number}')\n\n</code></pre>"},{"location":"lr_3/lr_3_1/prac_1/#_2","title":"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0421\u043a\u0440\u0438\u043f\u0442\u0430","text":"<p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0447\u0435\u0440\u0435\u0437 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 objects \u043c\u043e\u0434\u0435\u043b\u0435\u0439</p> <p>\u0421\u043a\u0440\u0438\u043f\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438:</p> <ol> <li> <p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0410\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432: \u0413\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 7 \u0430\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u0441 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438.</p> </li> <li> <p>\u0412\u044b\u0434\u0430\u0447\u0430 \u0412\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u0423\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0439: \u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0435 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0435 \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u0442\u0438\u043f\u0430 \u0438 \u0434\u0430\u0442\u044b \u0432\u044b\u0434\u0430\u0447\u0438.</p> </li> <li> <p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0410\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439: \u0413\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 6 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 \u0441 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438.</p> </li> <li> <p>\u0421\u0432\u044f\u0437\u044c \u0410\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u0441 \u0410\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f\u043c\u0438: \u041a\u0430\u0436\u0434\u043e\u043c\u0443 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0443 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u0442 1 \u0434\u043e 3 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 \u0447\u0435\u0440\u0435\u0437 \u043c\u043e\u0434\u0435\u043b\u044c <code>Owning</code>.</p> </li> </ol>"},{"location":"lr_3/lr_3_1/prac_1/#_3","title":"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0441\u043a\u0440\u0438\u043f\u0442\u0430","text":""},{"location":"lr_3/lr_3_1/prac_2/","title":"Prac_2","text":""},{"location":"lr_3/lr_3_1/prac_2/#_1","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0441\u0442\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432","text":""},{"location":"lr_3/lr_3_1/prac_2/#1","title":"1. \u041c\u0430\u0448\u0438\u043d\u044b \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0439 \u041c\u0430\u0440\u043a\u0438:","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0432\u0441\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043c\u0430\u0440\u043a\u0438 \u201cToyota\u201d. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>Car.objects.filter(brand='Toyota')\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_2/#2","title":"2. \u0412\u043e\u0434\u0438\u0442\u0435\u043b\u0438 \u0441 \u041a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c \u0418\u043c\u0435\u043d\u0435\u043c:","text":"<p>\u0418\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432\u0441\u0435\u0445 \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u201c\u041e\u043b\u0435\u0433\u201d. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>Driver.objects.filter(first_name='\u041e\u043b\u0435\u0433')\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_2/#3-id","title":"3. \u0423\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0435 \u041f\u043e ID \u0412\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430:","text":"<p>\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430, \u0437\u0430\u0442\u0435\u043c \u043d\u0430\u0445\u043e\u0434\u0438\u043c \u0435\u0433\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0435 \u043f\u043e ID. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>random_driver = Driver.objects.order_by('?').first()\nDriverLicense.objects.get(id_car_owner=random_driver)\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_2/#4","title":"4. \u0412\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u044b \u0410\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0433\u043e \u0426\u0432\u0435\u0442\u0430:","text":"<p>\u0412\u044b\u0432\u043e\u0434\u0438\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0441\u0435\u0445 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430\u0445 \u043a\u0440\u0430\u0441\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>Driver.objects.filter(cars__color='\u041a\u0440\u0430\u0441\u043d\u044b\u0439').distinct()\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_2/#5","title":"5. \u0412\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u044b \u0441 \u0413\u043e\u0434\u043e\u043c \u041d\u0430\u0447\u0430\u043b\u0430 \u0412\u043b\u0430\u0434\u0435\u043d\u0438\u044f:","text":"<p>\u0418\u0449\u0435\u043c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432, \u043d\u0430\u0447\u0430\u0432\u0448\u0438\u0445 \u0432\u043b\u0430\u0434\u0435\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u043c \u0441 2010 \u0433\u043e\u0434\u0430. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>Driver.objects.filter(owning__start_date__year=2010).distinct()\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_3/","title":"Prac_3","text":""},{"location":"lr_3/lr_3_1/prac_3/#django","title":"\u0410\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u0438 \u0410\u043d\u043d\u043e\u0442\u0430\u0446\u0438\u044f \u0417\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 Django","text":""},{"location":"lr_3/lr_3_1/prac_3/#1","title":"1. \u0414\u0430\u0442\u0430 \u0412\u044b\u0434\u0430\u0447\u0438 \u0421\u0430\u043c\u043e\u0433\u043e \u0421\u0442\u0430\u0440\u0448\u0435\u0433\u043e \u0412\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0423\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f:","text":"<p>\u041d\u0430\u0445\u043e\u0434\u0438\u043c \u0434\u0430\u0442\u0443 \u0432\u044b\u0434\u0430\u0447\u0438 \u0441\u0430\u043c\u043e\u0433\u043e \u0441\u0442\u0430\u0440\u043e\u0433\u043e \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f \u0432 \u0431\u0430\u0437\u0435. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>from django.db.models import Min\n\nDriverLicense.objects.aggregate(Min('date_of_issue'))\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_3/#2","title":"2. \u0421\u0430\u043c\u0430\u044f \u041f\u043e\u0437\u0434\u043d\u044f\u044f \u0414\u0430\u0442\u0430 \u0412\u043b\u0430\u0434\u0435\u043d\u0438\u044f \u041c\u0430\u0448\u0438\u043d\u043e\u0439:","text":"<p>\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u0441\u0430\u043c\u0443\u044e \u043f\u043e\u0437\u0434\u043d\u044e\u044e \u0434\u0430\u0442\u0443 \u0432\u043b\u0430\u0434\u0435\u043d\u0438\u044f \u043c\u0430\u0448\u0438\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u0438 \u0432\u0441\u0435\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>from django.db.models import Max\n\nOwning.objects.aggregate(Max('end_date'))\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_3/#3","title":"3. \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u041c\u0430\u0448\u0438\u043d \u0434\u043b\u044f \u041a\u0430\u0436\u0434\u043e\u0433\u043e \u0412\u043e\u0434\u0438\u0442\u0435\u043b\u044f:","text":"<p>\u041f\u043e\u0434\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0448\u0438\u043d, \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0430\u0449\u0438\u0445 \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044e. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>from django.db.models import Count\n\nDriver.objects.annotate(num_cars=Count('cars')).values('username', 'num_cars')\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_3/#4","title":"4. \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u041c\u0430\u0448\u0438\u043d \u041a\u0430\u0436\u0434\u043e\u0439 \u041c\u0430\u0440\u043a\u0438:","text":"<p>\u0412\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0448\u0438\u043d \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043c\u0430\u0440\u043a\u0438 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>Car.objects.values('brand').annotate(total=Count('id_car')).order_by('brand')\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_1/prac_3/#5","title":"5. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0410\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u041f\u043e \u0414\u0430\u0442\u0435 \u0412\u044b\u0434\u0430\u0447\u0438 \u0423\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f:","text":"<p>\u0421\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0430\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u0432\u044b\u0434\u0430\u0447\u0438 \u0438\u0445 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f. \u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430</p> <pre><code>Driver.objects.annotate(earliest_license_date=Min('driverlicense__date_of_issue')).order_by(\n    'earliest_license_date'\n).distinct()\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 </p>"},{"location":"lr_3/lr_3_2/broker/","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0431\u0440\u043e\u043a\u0435\u0440\u0430\u043c\u0438","text":""},{"location":"lr_3/lr_3_2/broker/#_2","title":"\u041b\u0438\u0441\u0442\u0438\u043d\u0433 \u043a\u043e\u0434\u0430","text":"<p><code>filters.py</code></p> <pre><code>import django_filters\n\nfrom backend.broker.models import Broker\n\n\nclass BrokerFilter(django_filters.FilterSet):\n    firm = django_filters.CharFilter(method='firm_filter')\n\n    def firm_filter(self, queryset, name, value):\n        if value.isdigit():\n            return queryset.filter(firm__id=int(value))\n\n        return queryset.filter(firm__name__icontains=value)\n\n    class Meta:\n        model = Broker\n        fields = ()\n</code></pre> <p><code>serializers.py</code></p> <pre><code>from django.contrib.auth import get_user_model\nfrom rest_framework import serializers\n\nfrom backend.broker.models import Broker, Firm\n\nUser = get_user_model()\n\n\nclass BrokerUserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = (\n            'id', 'full_name', 'email'\n        )\n\n\nclass RetrieveBrokerFirmSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Firm\n        fields = (\n            'id', 'name', 'address',\n            'brokers_count'\n        )\n\n\nclass RetrieveBrokerSerializer(serializers.ModelSerializer):\n    user = BrokerUserSerializer(read_only=True)\n    firm = RetrieveBrokerFirmSerializer(read_only=True)\n\n    class Meta:\n        model = Broker\n        fields = (\n            'id', 'profit_percentage', 'fixed_monthly_amount',\n            'user', 'firm'\n        )\n\n\nclass CRUDBrokerSerializer(serializers.ModelSerializer):\n    firm = serializers.PrimaryKeyRelatedField(queryset=Firm.objects.all())\n\n    class Meta:\n        model = Broker\n        fields = (\n            'id', 'profit_percentage', 'fixed_monthly_amount',\n            'firm'\n        )\n\n\nclass ListBrokersSerializer(serializers.ModelSerializer):\n    email = serializers.EmailField(source='user.email', read_only=True)\n    full_name = serializers.CharField(source='user.full_name', read_only=True)\n    firm = serializers.SlugRelatedField(slug_field='name', read_only=True)\n\n    class Meta:\n        model = Broker\n        fields = (\n            'id', 'profit_percentage', 'fixed_monthly_amount',\n            'email', 'full_name', 'firm'\n        )\n</code></pre> <p><code>urls.py</code></p> <pre><code>from django.urls import include, path\nfrom rest_framework.routers import DefaultRouter\n\nfrom .views import BrokerViewSet\n\nrouter = DefaultRouter()\nrouter.register(r'', BrokerViewSet)\n\nurlpatterns = [\n    path('', include(router.urls)),\n]\n</code></pre> <p><code>views.py</code></p> <pre><code>from django.utils.translation import gettext_lazy as _\nfrom django_filters.rest_framework import DjangoFilterBackend\nfrom rest_framework import permissions\nfrom rest_framework.exceptions import ValidationError\nfrom rest_framework.filters import OrderingFilter, SearchFilter\n\nfrom backend.api.v1.broker.filters import BrokerFilter\nfrom backend.api.v1.broker.serializers import (\n    CRUDBrokerSerializer,\n    ListBrokersSerializer,\n    RetrieveBrokerSerializer\n)\nfrom backend.api.v1.core.mixins import ActionMeMixin\nfrom backend.api.v1.core.permissions import IsUserRoleObject\nfrom backend.api.v1.core.viewsets import SpecificModelViewSet\nfrom backend.broker.models import Broker\n\n\nclass BrokerViewSet(ActionMeMixin, SpecificModelViewSet):\n    queryset = Broker.objects.select_related('user', 'firm').all()\n\n    serializer_class = CRUDBrokerSerializer\n    serializer_classes_by_action = {\n        'retrieve': RetrieveBrokerSerializer,\n        'list': ListBrokersSerializer\n    }\n\n    permission_classes = [permissions.IsAuthenticated, IsUserRoleObject]\n\n    filter_backends = (DjangoFilterBackend, OrderingFilter, SearchFilter)\n    filterset_class = BrokerFilter\n    ordering = ('fixed_monthly_amount', 'profit_percentage')\n    search_fields = ('user__email',)\n\n    def perform_create(self, serializer):\n        if self.queryset.filter(user=self.request.user).exists():\n            raise ValidationError({'detail': _('You are already broker.')})\n\n        serializer.save(user=self.request.user)\n</code></pre>"},{"location":"lr_3/lr_3_2/broker/#_3","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"lr_3/lr_3_2/broker/#_4","title":"\u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b","text":"<ul> <li><code>BrokerUserSerializer</code>: \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0431\u0440\u043e\u043a\u0435\u0440\u0430, \u0430\u0441\u0441\u043e\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441 \u043c\u043e\u0434\u0435\u043b\u044c\u044e <code>User</code>.</li> <li><code>RetrieveBrokerFirmSerializer</code>: \u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0444\u0438\u0440\u043c\u044b \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u0430.</li> <li><code>RetrieveBrokerSerializer</code>: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0431\u0440\u043e\u043a\u0435\u0440\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435   \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u0444\u0438\u0440\u043c\u044b.</li> <li><code>CRUDBrokerSerializer</code>: \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432.</li> <li><code>ListBrokersSerializer</code>: \u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443, \u043f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438   \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u0440\u043c\u044b.</li> </ul>"},{"location":"lr_3/lr_3_2/broker/#_5","title":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f","text":"<ul> <li><code>BrokerFilter</code>: \u041a\u043b\u0430\u0441\u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 <code>Broker</code>, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432 \u043f\u043e <code>firm</code>, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044f \u043a\u0430\u043a   \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 ID, \u0442\u0430\u043a \u0438 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0435 \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u0440\u043c\u044b.</li> </ul>"},{"location":"lr_3/lr_3_2/broker/#viewset","title":"ViewSet","text":"<ul> <li><code>BrokerViewSet</code>: \u041d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u043c\u044b\u0439 ViewSet \u0434\u043b\u044f \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0439 CRUD-\u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435   \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438, \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438 \u0438 \u043f\u043e\u0438\u0441\u043a\u0430.</li> </ul>"},{"location":"lr_3/lr_3_2/broker/#_6","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u0413\u0438\u0431\u043a\u043e\u0441\u0442\u044c \u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0437\u043d\u044b\u0445 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432 \u0434\u043b\u044f \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 (<code>retrieve</code>, <code>list</code>) \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442   \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430.</li> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0441 <code>django_filters</code>: \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 <code>django_filters</code> \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432, \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442   \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0438\u0441\u043a\u0430 \u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430.</li> <li>\u0420\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0414\u043e\u0441\u0442\u0443\u043f\u0430: \u0412\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 <code>IsUserRoleObject</code>, \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u044e\u0449\u0435\u0439, \u0447\u0442\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u043c\u043e\u0433\u0443\u0442   \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c\u0438, \u043a \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0443 \u043d\u0438\u0445 \u0435\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f.</li> <li>\u041a\u0430\u0441\u0442\u043e\u043c\u043d\u0430\u044f \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f: \u0412 <code>perform_create</code> \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f,   \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u044e\u0449\u0430\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</li> </ul>"},{"location":"lr_3/lr_3_2/firm/","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0444\u0438\u0440\u043c\u0430\u043c\u0438","text":"<p><code>serializers.py</code></p> <pre><code>from backend.broker.models import Broker, Firm\nfrom rest_framework import serializers\n\n\nclass FirmBrokerSerializer(serializers.ModelSerializer):\n    email = serializers.EmailField(source='user.email', read_only=True)\n    full_name = serializers.CharField(source='user.full_name', read_only=True)\n\n    class Meta:\n        model = Broker\n        fields = (\n            'id', 'profit_percentage', 'fixed_monthly_amount',\n            'email', 'full_name'\n        )\n\n\nclass FirmDetailSerializer(serializers.ModelSerializer):\n    brokers = FirmBrokerSerializer(read_only=True, many=True)\n\n    class Meta:\n        model = Firm\n        fields = (\n            'id', 'name', 'address',\n            'brokers_count', 'brokers'\n        )\n\n\nclass FirmListSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Firm\n        fields = (\n            'id', 'name', 'address',\n            'brokers_count'\n        )\n</code></pre> <p><code>urls.py</code></p> <pre><code>from django.urls import path\n\nfrom . import views\n\nurlpatterns = [\n    path('', views.FirmListView.as_view(), name='firm-list'),\n    path('&lt;int:pk&gt;/', views.FirmDetailView.as_view(), name='detail-firm'),\n]\n</code></pre> <p><code>views.py</code></p> <pre><code>from backend.broker.models import Firm\nfrom rest_framework import generics, permissions\nfrom rest_framework.filters import OrderingFilter, SearchFilter\n\nfrom .serializers import FirmDetailSerializer, FirmListSerializer\n\n\nclass FirmDetailView(generics.RetrieveAPIView):\n    queryset = Firm.objects.prefetch_related('brokers').all()\n\n    serializer_class = FirmDetailSerializer\n\n    permission_classes = [permissions.IsAuthenticated]\n\n\nclass FirmListView(generics.ListAPIView):\n    queryset = Firm.objects.all()\n\n    serializer_class = FirmListSerializer\n\n    permission_classes = [permissions.IsAuthenticated]\n\n    filter_backends = (OrderingFilter, SearchFilter)\n    ordering = ('name',)\n    search_fields = ('name',)\n</code></pre>"},{"location":"lr_3/lr_3_2/firm/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"lr_3/lr_3_2/firm/#_3","title":"\u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b","text":"<ul> <li><code>FirmListSerializer</code>: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u0444\u0438\u0440\u043c, \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044f \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043a\u0430\u0436\u0434\u043e\u0439 \u0444\u0438\u0440\u043c\u0435.</li> <li><code>FirmDetailSerializer</code>: \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0444\u0438\u0440\u043c\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u043f\u0438\u0441\u043e\u043a \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432, \u0430\u0441\u0441\u043e\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0441   \u0444\u0438\u0440\u043c\u043e\u0439, \u0441 \u0438\u0445 email \u0438 \u043f\u043e\u043b\u043d\u044b\u043c \u0438\u043c\u0435\u043d\u0435\u043c.</li> <li><code>FirmBrokerSerializer</code>: \u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u0444\u0438\u0440\u043c\u044b.</li> </ul>"},{"location":"lr_3/lr_3_2/firm/#views","title":"Views","text":"<ul> <li><code>FirmListView</code>: \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0444\u0438\u0440\u043c, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044e \u0438 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443.</li> <li><code>FirmDetailView</code>: \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0444\u0438\u0440\u043c\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432.</li> </ul>"},{"location":"lr_3/lr_3_2/firm/#url-","title":"URL-\u043f\u0443\u0442\u0438","text":"<ul> <li>\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u044b URL-\u043f\u0443\u0442\u0438 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u0444\u0438\u0440\u043c \u0438 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0444\u0438\u0440\u043c\u0435, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044f \u043b\u0435\u0433\u043a\u043e\u0441\u0442\u044c \u0432 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441   \u0444\u0440\u043e\u043d\u0442\u0435\u043d\u0434\u043e\u043c.</li> </ul>"},{"location":"lr_3/lr_3_2/firm/#_4","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (<code>prefetch_related</code>): \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 <code>prefetch_related</code> \u0432 <code>FirmDetailView</code>   \u0434\u043b\u044f \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0444\u0438\u0440\u043c\u0435 \u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u043d\u0435\u0439 \u0431\u0440\u043e\u043a\u0435\u0440\u0430\u0445.</li> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0438 \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430: \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0438 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438 \u0432 <code>FirmListView</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c   \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043d\u0430\u0432\u0438\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0441\u043f\u0438\u0441\u043a\u0443 \u0444\u0438\u0440\u043c.</li> <li>\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a API \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445   \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0447\u0435\u0440\u0435\u0437 <code>permissions.IsAuthenticated</code> \u043f\u043e\u0432\u044b\u0448\u0430\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul>"},{"location":"lr_3/lr_3_2/manufacturer/","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f\u043c\u0438","text":"<p><code>serializers.py</code></p> <pre><code>from backend.manufacturer.models import Manufacturer\nfrom django.contrib.auth import get_user_model\nfrom rest_framework import serializers\n\nUser = get_user_model()\n\n\nclass ManufacturerUserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = (\n            'id', 'full_name', 'email'\n        )\n\n\nclass RetrieveManufacturerSerializer(serializers.ModelSerializer):\n    user = ManufacturerUserSerializer(read_only=True)\n\n    class Meta:\n        model = Manufacturer\n        fields = (\n            'id', 'firm_name', 'address',\n            'contact_info', 'user', 'products_count'\n        )\n\n\nclass ListManufacturerSerializer(serializers.ModelSerializer):\n    email = serializers.EmailField(source='user.email', read_only=True)\n    full_name = serializers.CharField(source='user.full_name', read_only=True)\n\n    class Meta:\n        model = Manufacturer\n        fields = (\n            'id', 'firm_name', 'address',\n            'contact_info', 'email', 'full_name',\n            'products_count'\n        )\n\n\nclass CRUDManufacturerSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Manufacturer\n        fields = (\n            'id', 'firm_name', 'address',\n            'contact_info'\n        )\n</code></pre> <p><code>urls.py</code></p> <pre><code>from django.urls import include, path\nfrom rest_framework.routers import DefaultRouter\n\nfrom .views import ManufacturerViewSet\n\nrouter = DefaultRouter()\nrouter.register(r'', ManufacturerViewSet)\n\nurlpatterns = [\n    path('', include(router.urls)),\n]\n</code></pre> <p><code>views.py</code></p> <pre><code>from backend.api.v1.core.mixins import ActionMeMixin\nfrom backend.api.v1.core.permissions import IsUserRoleObject\nfrom backend.api.v1.core.viewsets import SpecificModelViewSet\nfrom backend.api.v1.manufacturer.serializers import (\n    CRUDManufacturerSerializer,\n    ListManufacturerSerializer,\n    RetrieveManufacturerSerializer\n)\nfrom backend.manufacturer.models import Manufacturer\nfrom rest_framework import permissions\nfrom rest_framework.filters import OrderingFilter, SearchFilter\n\n\nclass ManufacturerViewSet(ActionMeMixin, SpecificModelViewSet):\n    queryset = Manufacturer.objects.select_related('user').all()\n\n    serializer_class = CRUDManufacturerSerializer\n    serializer_classes_by_action = {\n        'retrieve': RetrieveManufacturerSerializer,\n        'list': ListManufacturerSerializer,\n    }\n\n    permission_classes = [permissions.IsAuthenticated, IsUserRoleObject]\n\n    filter_backends = (OrderingFilter, SearchFilter)\n    ordering = ('firm_name',)\n    search_fields = ('firm_name', 'user__email')\n\n    def perform_create(self, serializer):\n        if self.queryset.filter(user=self.request.user).exists():\n            raise ValidationError({'detail': _('You are already manufacturer.')})\n\n        serializer.save(user=self.request.user)\n</code></pre>"},{"location":"lr_3/lr_3_2/manufacturer/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"lr_3/lr_3_2/manufacturer/#_3","title":"\u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b","text":"<ul> <li><code>ManufacturerUserSerializer</code>: \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u043e\u043c \u0441 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u043c, \u0432\u043a\u043b\u044e\u0447\u0430\u044f   \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440, \u043f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443.</li> <li><code>RetrieveManufacturerSerializer</code>: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435   \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</li> <li><code>ListManufacturerSerializer</code>: \u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439, \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044f \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e   \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043a\u0430\u0436\u0434\u043e\u043c, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432.</li> <li><code>CRUDManufacturerSerializer</code>: \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043e   \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f\u0445.</li> </ul>"},{"location":"lr_3/lr_3_2/manufacturer/#viewset","title":"ViewSet","text":"<ul> <li><code>ManufacturerViewSet</code>: \u041d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 ViewSet, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u044b (GET, POST, PUT, DELETE),   \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f.</li> </ul>"},{"location":"lr_3/lr_3_2/manufacturer/#_4","title":"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 <code>DefaultRouter</code> \u0438\u0437 DRF \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f URL-\u043f\u0443\u0442\u0435\u0439 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0445 ViewSet.</li> </ul>"},{"location":"lr_3/lr_3_2/manufacturer/#_5","title":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f, \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0438 \u041f\u043e\u0438\u0441\u043a","text":"<ul> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432 <code>OrderingFilter</code> \u0438 <code>SearchFilter</code> \u0434\u043b\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438 \u0438 \u043f\u043e\u0438\u0441\u043a\u0430 \u0441\u0440\u0435\u0434\u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0444\u0438\u0440\u043c\u044b \u0438   \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</li> </ul>"},{"location":"lr_3/lr_3_2/manufacturer/#_6","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432 \u043f\u043e \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c: \u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432 \u0434\u043b\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439   \u0447\u0442\u0435\u043d\u0438\u044f \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0442\u0435\u043c, \u043a\u0430\u043a\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c   API.</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0414\u0430\u043d\u043d\u044b\u0445 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f: \u0421\u0432\u044f\u0437\u044b\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0431\u043e\u043b\u0435\u0435   \u0433\u043b\u0443\u0431\u043e\u043a\u0443\u044e \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044e \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c.</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0414\u0443\u0431\u043b\u0438\u043a\u0430\u0442\u043e\u0432: \u041c\u0435\u0442\u043e\u0434 <code>perform_create</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043d\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f   \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u043e\u0434\u043d\u0438\u043c \u0438 \u0442\u0435\u043c \u0436\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c.</li> <li>\u0414\u043e\u0441\u0442\u0443\u043f \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439: \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a API \u0441   \u043f\u043e\u043c\u043e\u0449\u044c\u044e <code>permissions.IsAuthenticated</code> \u0438 <code>IsUserRoleObject</code> \u043f\u043e\u0432\u044b\u0448\u0430\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul>"},{"location":"lr_3/lr_3_2/product/","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430\u043c\u0438","text":"<p><code>filters.py</code></p> <pre><code>import django_filters\nfrom backend.product.choices import TradeStatus\nfrom backend.product.models import Product, ProductBatch\nfrom django.db.models import Q\n\n\nclass ProductFilter(django_filters.FilterSet):\n    manufacturer = django_filters.CharFilter(method='filter_manufacturer')\n    category = django_filters.CharFilter(field_name='category', lookup_expr='iexact')\n\n    def filter_manufacturer(self, queryset, name, value):\n        if value.isdigit():\n            return queryset.filter(manufacturer__id=int(value))\n\n        return queryset.filter(\n            Q(manufacturer__firm_name__icontains=value) |\n            Q(manufacturer__user__email__icontains=value)\n        )\n\n    class Meta:\n        model = Product\n        fields = ()\n\n\nclass ProductBatchFilter(django_filters.FilterSet):\n    is_available = django_filters.BooleanFilter(method='filter_is_available')\n\n    def filter_is_available(self, queryset, name, value):\n        if value:\n            return queryset.exclude(trades__status__in=TradeStatus.unavailable())\n\n        return queryset.filter(trades__status__in=TradeStatus.unavailable())\n\n    class Meta:\n        model = ProductBatch\n        fields = ()\n</code></pre> <p><code>serializers.py</code></p> <pre><code>from backend.manufacturer.models import Manufacturer\nfrom backend.product.models import (\n    Product,\n    ProductBatch\n)\nfrom backend.trade.models import Trade\nfrom rest_framework import serializers\n\n\nclass ProductManufacturerSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Manufacturer\n        fields = (\n            'id', 'firm_name', 'products_count'\n        )\n\n\nclass ProductProductBatchSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = ProductBatch\n        fields = (\n            'id', 'quantity', 'price'\n        )\n\n\nclass RetrieveProductSerializer(serializers.ModelSerializer):\n    manufacturer = ProductManufacturerSerializer(read_only=True)\n\n    class Meta:\n        model = Product\n        fields = (\n            'id', 'name',\n            'unique_code', 'category', 'weight',\n            'production_date', 'expiry_date', 'measurement_unit',\n            'manufacturer', 'batches_count'\n        )\n\n\nclass ListProductsSerializer(serializers.ModelSerializer):\n    manufacturer = serializers.SlugRelatedField(slug_field='firm_name', read_only=True)\n\n    class Meta:\n        model = Product\n        fields = (\n            'id', 'name', 'unique_code',\n            'category', 'weight', 'production_date',\n            'expiry_date', 'measurement_unit', 'manufacturer',\n            'batches_count',\n        )\n\n\nclass CRUDProductSerializer(serializers.ModelSerializer):\n    manufacturer = serializers.SlugRelatedField(slug_field='firm_name', read_only=True)\n\n    class Meta:\n        model = Product\n        fields = (\n            'id', 'name', 'unique_code',\n            'category', 'weight', 'production_date',\n            'expiry_date', 'measurement_unit', 'manufacturer'\n        )\n        read_only_fields = ('unique_code',)\n\n\nclass ListProductBatchSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = ProductBatch\n        fields = (\n            'id', 'quantity', 'price',\n            'delivery_conditions', 'trades_count', 'is_available'\n        )\n\n\nclass ProductBatchTradesSerializer(serializers.ModelSerializer):\n    broker = serializers.CharField(source='broker.user.full_name', read_only=True)\n\n    class Meta:\n        model = Trade\n        fields = (\n            'id', 'start_time', 'end_time',\n            'status', 'broker'\n        )\n\n\nclass RetrieveProductBatchSerializer(serializers.ModelSerializer):\n    trades = ProductBatchTradesSerializer(many=True, read_only=True)\n\n    class Meta:\n        model = ProductBatch\n        fields = (\n            'id', 'quantity', 'price',\n            'delivery_conditions', 'trades_count', 'trades',\n            'is_available'\n        )\n\n\nclass CRUDProductBatchSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = ProductBatch\n        fields = (\n            'id', 'quantity', 'price',\n            'delivery_conditions'\n        )\n</code></pre> <p><code>urls.py</code></p> <pre><code>from django.urls import include, path\nfrom rest_framework.routers import DefaultRouter\nfrom rest_framework_nested.routers import NestedSimpleRouter\n\nfrom .views import (\n    ProductBatchViewSet,\n    ProductViewSet\n)\n\nrouter = DefaultRouter()\nrouter.register(r'', ProductViewSet)\n\nproduct_batches_router = NestedSimpleRouter(router, r'', lookup='product')\nproduct_batches_router.register(r'batches', ProductBatchViewSet)\n\nurlpatterns = [\n    path('', include(router.urls)),\n    path('', include(product_batches_router.urls))\n]\n</code></pre> <p><code>views.py</code></p> <pre><code>from backend.api.v1.core.permissions import (IsProductBatchAvailable, IsUserManufacturer,\n                                             IsUserManufacturerNestedProduct, IsUserManufacturerObject)\nfrom backend.api.v1.core.viewsets import SpecificModelViewSet\nfrom backend.api.v1.product.filters import ProductBatchFilter, ProductFilter\nfrom backend.api.v1.product.serializers import (CRUDProductBatchSerializer, CRUDProductSerializer,\n                                                ListProductBatchSerializer,\n                                                ListProductsSerializer, RetrieveProductBatchSerializer,\n                                                RetrieveProductSerializer)\nfrom backend.product.models import (\n    Product,\n    ProductBatch\n)\nfrom django.db.models.functions import Now\nfrom django.shortcuts import get_object_or_404\nfrom django_filters.rest_framework import DjangoFilterBackend\nfrom rest_framework import permissions\nfrom rest_framework.filters import OrderingFilter, SearchFilter\n\n\nclass ProductViewSet(SpecificModelViewSet):\n    queryset = Product.objects.select_related('manufacturer').filter(expiry_date__gte=Now())\n\n    serializer_class = CRUDProductSerializer\n    serializer_classes_by_action = {\n        'retrieve': RetrieveProductSerializer,\n        'list': ListProductsSerializer,\n    }\n\n    permission_classes_common = [permissions.IsAuthenticated]\n    permission_classes_by_action = {\n        'create': [IsUserManufacturer],\n        'update': [IsUserManufacturerObject],\n        'partial_update': [IsUserManufacturerObject],\n        'destroy': [IsUserManufacturerObject]\n    }\n\n    filter_backends = (DjangoFilterBackend, OrderingFilter, SearchFilter)\n    filterset_class = ProductFilter\n    ordering = ('expiry_date', 'expiry_date', 'weight', 'name', 'id')\n    search_fields = ('name', '=unique_code')\n\n    def perform_create(self, serializer):\n        serializer.save(manufacturer=self.request.user.manufacturer)\n\n\nclass ProductBatchViewSet(SpecificModelViewSet):\n    queryset = ProductBatch.objects.all()\n\n    serializer_class = CRUDProductBatchSerializer\n    serializer_classes_by_action = {\n        'retrieve': RetrieveProductBatchSerializer,\n        'list': ListProductBatchSerializer,\n    }\n\n    permission_classes_common = [permissions.IsAuthenticated]\n    permission_classes_by_action = {\n        'create': [IsUserManufacturerNestedProduct],\n        'update': [IsUserManufacturerNestedProduct, IsProductBatchAvailable],\n        'partial_update': [IsUserManufacturerNestedProduct, IsProductBatchAvailable],\n        'destroy': [IsUserManufacturerNestedProduct, IsProductBatchAvailable]\n    }\n\n    filter_backends = (DjangoFilterBackend, OrderingFilter)\n    filterset_class = ProductBatchFilter\n    ordering = ('price', 'quantity', 'id')\n\n    def get_queryset(self):\n        return super().get_queryset().filter(product=self.get_product())\n\n    def get_product(self):\n        return get_object_or_404(Product, pk=self.kwargs.get('product_pk'))\n\n    def perform_create(self, serializer):\n        serializer.save(product=self.get_product())\n</code></pre>"},{"location":"lr_3/lr_3_2/product/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"lr_3/lr_3_2/product/#_3","title":"\u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b","text":"<ul> <li>\u041f\u0440\u043e\u0434\u0443\u043a\u0442\u044b: \u0420\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b (<code>ListProductsSerializer</code>, <code>RetrieveProductSerializer</code>, <code>CRUDProductSerializer</code>)   \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u0433\u0438\u0431\u043a\u043e\u0441\u0442\u044c \u0432 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430\u0445, \u043e\u0442 \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u043e \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441   \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0435\u0439 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439.</li> <li>\u041f\u0430\u0440\u0442\u0438\u0438 \u041f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432: \u0410\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e, \u0434\u043b\u044f \u043f\u0430\u0440\u0442\u0438\u0439 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u044b   \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b (<code>ListProductBatchSerializer</code>, <code>RetrieveProductBatchSerializer</code>, <code>CRUDProductBatchSerializer</code>),   \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043e \u043f\u0430\u0440\u0442\u0438\u044f\u0445, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438.</li> </ul>"},{"location":"lr_3/lr_3_2/product/#_4","title":"\u0424\u0438\u043b\u044c\u0442\u0440\u044b","text":"<ul> <li><code>ProductFilter</code> \u0438 <code>ProductBatchFilter</code>: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u043e\u0432 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u0438   \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432 \u0438 \u043f\u0430\u0440\u0442\u0438\u0439 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432 \u043f\u043e \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u044f\u043c, \u0443\u043b\u0443\u0447\u0448\u0430\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u043e\u043f\u044b\u0442.</li> </ul>"},{"location":"lr_3/lr_3_2/product/#viewsets","title":"ViewSets","text":"<ul> <li><code>ProductViewSet</code> \u0438 <code>ProductBatchViewSet</code>: \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f ViewSets \u0441 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0445 \u0434\u043b\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432   \u0438 \u043d\u0430\u0431\u043e\u0440\u043e\u0432 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0433\u0438\u0431\u043a\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c \u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul>"},{"location":"lr_3/lr_3_2/product/#_5","title":"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 <code>DefaultRouter</code> \u0438 <code>NestedSimpleRouter</code> \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f RESTful URL-\u043f\u0443\u0442\u0435\u0439, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0445 \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b,   \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u043d\u0430\u0432\u0438\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e API.</li> </ul>"},{"location":"lr_3/lr_3_2/product/#_6","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u0412\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0420\u0435\u0441\u0443\u0440\u0441\u044b: \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 <code>ProductBatch</code> \u0432 <code>Product</code> \u0447\u0435\u0440\u0435\u0437 <code>NestedSimpleRouter</code>   \u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442 \u043f\u0440\u043e\u0434\u0432\u0438\u043d\u0443\u0442\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 DRF.</li> <li>\u041a\u0430\u0441\u0442\u043e\u043c\u043d\u0430\u044f \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f: \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u0442\u0430\u043a\u0438\u0445 \u043a\u0430\u043a \u043f\u043e\u0438\u0441\u043a \u043f\u043e   \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430\u043c \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439.</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0414\u043e\u0441\u0442\u0443\u043f\u0430: \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0441 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430\u043c\u0438 \u0438 \u043f\u0430\u0440\u0442\u0438\u044f\u043c\u0438 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432   \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u044e\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0440\u043e\u043b\u044f\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</li> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0421\u0440\u043e\u043a\u0430\u043c \u0413\u043e\u0434\u043d\u043e\u0441\u0442\u0438: <code>ProductViewSet</code> \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0443\u0435\u0442 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u044b, \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u044f \u0442\u0435, \u0447\u0435\u0439   \u0441\u0440\u043e\u043a \u0433\u043e\u0434\u043d\u043e\u0441\u0442\u0438 \u0438\u0441\u0442\u0435\u043a, \u0447\u0442\u043e \u043f\u043e\u0432\u044b\u0448\u0430\u0435\u0442 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438.</li> </ul>"},{"location":"lr_3/lr_3_2/trade/","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0442\u0440\u0435\u0439\u0434\u0430\u043c\u0438","text":"<p><code>filters.py</code></p> <pre><code>import django_filters\nfrom backend.trade.models import Trade\nfrom django.db.models import Q\n\n\nclass TradeFilter(django_filters.FilterSet):\n  broker = django_filters.CharFilter(method='filter_broker')\n  product_batch__product = django_filters.CharFilter(method='filter_product')\n  product_batch = django_filters.NumberFilter(field_name='product_batch__id')\n  status = django_filters.CharFilter(field_name='status', lookup_expr='iexact')\n\n  def filter_broker(self, queryset, name, value):\n    if value.isdigit():\n      return queryset.filter(broker__id=int(value))\n\n    return queryset.filter(broker__user__email__icontains=value)\n\n  def filter_product(self, queryset, name, value):\n    if value.isdigit():\n      return queryset.filter(product_batch__product__id=int(value))\n\n    return queryset.filter(\n      Q(product_batch__product__name__icontains=value) |\n      Q(product_batch__product__unique_code__iexact=value)\n    )\n\n  class Meta:\n    model = Trade\n    fields = ()\n</code></pre> <p><code>serializers.py</code></p> <pre><code>from django.utils.translation import gettext_lazy as _\nfrom rest_framework import serializers\nfrom rest_framework.exceptions import ValidationError\n\nfrom backend.broker.models import Broker\nfrom backend.product.models import Product, ProductBatch\nfrom backend.trade.models import Trade\n\n\nclass TradeProductBatchProductSerializer(serializers.ModelSerializer):\n    manufacturer = serializers.SlugRelatedField(slug_field='firm_name', read_only=True)\n\n    class Meta:\n        model = Product\n        fields = (\n            'id', 'name', 'unique_code',\n            'category', 'manufacturer'\n        )\n\n\nclass TradeProductBatchSerializer(serializers.ModelSerializer):\n    product = TradeProductBatchProductSerializer(read_only=True)\n\n    class Meta:\n        model = ProductBatch\n        fields = (\n            'id', 'product', 'quantity',\n            'price', 'delivery_conditions'\n        )\n\n\nclass TradeBrokerSerializer(serializers.ModelSerializer):\n    email = serializers.EmailField(source='user.email', read_only=True)\n    full_name = serializers.CharField(source='user.full_name', read_only=True)\n    firm = serializers.SlugRelatedField(slug_field='name', read_only=True)\n\n    class Meta:\n        model = Broker\n        fields = (\n            'id', 'email', 'full_name',\n            'firm', 'trades_conducted_count'\n        )\n\n\nclass RetrieveTradeSerializer(serializers.ModelSerializer):\n    broker = TradeBrokerSerializer(read_only=True)\n    product_batch = TradeProductBatchSerializer(read_only=True)\n\n    class Meta:\n        model = Trade\n        fields = (\n            'id', 'start_time', 'end_time',\n            'status', 'total_amount', 'broker',\n            'product_batch'\n        )\n\n\nclass ListTradeSerializer(serializers.ModelSerializer):\n    broker = serializers.CharField(source='broker.user.full_name', read_only=True)\n    product = serializers.CharField(source='product_batch.product.name', read_only=True)\n    quantity = serializers.IntegerField(source='product_batch.quantity', read_only=True)\n\n    class Meta:\n        model = Trade\n        fields = (\n            'id', 'start_time', 'end_time',\n            'status', 'total_amount', 'broker',\n            'product', 'quantity'\n        )\n\n\nclass UpdateDeleteTradeSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Trade\n        fields = (\n            'id', 'status', 'total_amount'\n        )\n\n\nclass CreateTradeSerializer(serializers.ModelSerializer):\n    product_batch = serializers.PrimaryKeyRelatedField(queryset=ProductBatch.objects.all())\n\n    class Meta:\n        model = Trade\n        fields = (\n            'id', 'total_amount', 'product_batch'\n        )\n\n    def validate_product_batch(self, value):\n        if not value.is_available:\n            raise ValidationError(_('The selected product batch is not available for trading.'))\n        return value\n</code></pre> <p><code>urls.py</code></p> <pre><code>from django.urls import include, path\nfrom rest_framework.routers import DefaultRouter\n\nfrom .views import TradeViewSet\n\nrouter = DefaultRouter()\nrouter.register(r'', TradeViewSet)\n\nurlpatterns = [\n    path('', include(router.urls)),\n]\n</code></pre> <p><code>views.py</code></p> <pre><code>from django_filters.rest_framework import DjangoFilterBackend\nfrom rest_framework import permissions\nfrom rest_framework.filters import OrderingFilter\n\nfrom backend.api.v1.core.permissions import (\n    IsTradeChangeable,\n    IsUserBroker,\n    IsUserBrokerObject\n)\nfrom backend.api.v1.core.viewsets import SpecificModelViewSet\nfrom backend.api.v1.trade.filters import TradeFilter\nfrom backend.api.v1.trade.serializers import (\n    CreateTradeSerializer,\n    ListTradeSerializer,\n    RetrieveTradeSerializer,\n    UpdateDeleteTradeSerializer\n)\nfrom backend.trade.models import Trade\n\n\nclass TradeViewSet(SpecificModelViewSet):\n    queryset = Trade.objects.select_related('broker', 'product_batch').all()\n\n    serializer_class = UpdateDeleteTradeSerializer\n    serializer_classes_by_action = {\n        'retrieve': RetrieveTradeSerializer,\n        'list': ListTradeSerializer,\n        'create': CreateTradeSerializer\n    }\n\n    permission_classes_common = [permissions.IsAuthenticated]\n    permission_classes_by_action = {\n        'create': [IsUserBroker],\n        'update': [IsUserBrokerObject, IsTradeChangeable],\n        'partial_update': [IsUserBrokerObject, IsTradeChangeable],\n        'destroy': [IsUserBrokerObject],\n    }\n\n    filter_backends = (DjangoFilterBackend, OrderingFilter)\n    filterset_class = TradeFilter\n    ordering = ('product_batch', 'status', 'broker', 'id')\n\n    def perform_create(self, serializer):\n        serializer.save(broker=self.request.user.broker)\n</code></pre>"},{"location":"lr_3/lr_3_2/trade/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"lr_3/lr_3_2/trade/#_3","title":"\u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u044b","text":"<ul> <li><code>RetrieveTradeSerializer</code>: \u0414\u0435\u0442\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0440\u0435\u0439\u0434\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0438 \u043f\u0430\u0440\u0442\u0438\u0438 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430.</li> <li><code>ListTradeSerializer</code>: \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0440\u0435\u0439\u0434\u043e\u0432 \u0441 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u0434\u043b\u044f \u043e\u0431\u0437\u043e\u0440\u0430.</li> <li><code>CreateTradeSerializer</code>: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u0442\u0440\u0435\u0439\u0434\u043e\u0432 \u0441 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u0440\u0442\u0438\u0438   \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430.</li> <li><code>UpdateDeleteTradeSerializer</code>: \u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u0440\u0435\u0439\u0434\u043e\u0432.</li> </ul>"},{"location":"lr_3/lr_3_2/trade/#_4","title":"\u0424\u0438\u043b\u044c\u0442\u0440\u044b","text":"<ul> <li><code>TradeFilter</code>: \u041a\u043b\u0430\u0441\u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 <code>Trade</code>, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u0442\u0440\u0435\u0439\u0434\u043e\u0432 \u043f\u043e \u0431\u0440\u043e\u043a\u0435\u0440\u0443, \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443,   \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u0438 \u0434\u0440\u0443\u0433\u0438\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c.</li> </ul>"},{"location":"lr_3/lr_3_2/trade/#viewset","title":"ViewSet","text":"<ul> <li><code>TradeViewSet</code>: \u041d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 ViewSet, \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u044e\u0449\u0438\u0439 CRUD \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0442\u0440\u0435\u0439\u0434\u043e\u0432, \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u043e\u0439 \u043b\u043e\u0433\u0438\u043a\u043e\u0439 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u0438   \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439.</li> </ul>"},{"location":"lr_3/lr_3_2/trade/#_5","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u041f\u0430\u0440\u0442\u0438\u0438 \u041f\u0440\u043e\u0434\u0443\u043a\u0442\u0430: \u0412 <code>CreateTradeSerializer</code> \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u0430\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0430\u044f   \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u0440\u0442\u0438\u0438 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430 \u0434\u043b\u044f \u0442\u043e\u0440\u0433\u043e\u0432\u043b\u0438, \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0442\u0440\u0435\u0439\u0434\u043e\u0432 \u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0442\u0438\u044f\u043c\u0438.</li> <li>\u0420\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0414\u043e\u0441\u0442\u0443\u043f\u0430: \u0412 ViewSet \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f\u043c \u0432   \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0440\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0442\u0440\u0435\u0439\u0434\u0430.</li> <li>\u0413\u0438\u0431\u043a\u0430\u044f \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 <code>TradeFilter</code> \u0441 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u043c\u0438 \u043c\u0435\u0442\u043e\u0434\u0430\u043c\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0443\u0434\u043e\u0431\u043d\u044b\u0439 \u043f\u043e\u0438\u0441\u043a \u0442\u0440\u0435\u0439\u0434\u043e\u0432   \u043f\u043e \u0441\u043b\u043e\u0436\u043d\u044b\u043c \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u044f\u043c.</li> <li>\u0412\u044b\u0431\u043e\u0440\u043e\u0447\u043d\u043e\u0435 \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0421\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432: \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043d\u044b\u0445 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432 \u0434\u043b\u044f \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445   \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 (<code>retrieve</code>, <code>list</code>, <code>create</code>) \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.</li> </ul>"}]}